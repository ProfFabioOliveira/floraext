[General]
# ==============================================================================
# 1. Configurações Gerais e de Saída (Output)
# ==============================================================================
# Define a rede (arquivo NED) que será simulada
network = floraext.simulations.LoRaNetworkTest

# Arquivos onde os resultados estatísticos serão salvos
# ${runnumber} gera um arquivo único para cada execução (seed)
output-scalar-file = ../results/n100-gw1-s${runnumber}.ini.sca
output-vector-file = ../results/n100-gw1-s${runnumber}.ini.vec

# Habilita a gravação de vetores de dados ao longo do tempo para todos os módulos
**.vector-recording = true

# Limite de segurança: nenhuma transmissão pode durar mais que 4s
**.maxTransmissionDuration = 4s

# Sensibilidade mínima do receptor: sinais abaixo de -110dBm são ignorados
**.energyDetection = -110dBm

# Gerador de números aleatórios (Mersenne Twister), essencial para simulações estocásticas
rng-class = "cMersenneTwister"


# ==============================================================================
# 2. Configurações do Gateway (LoRaGW)
# ==============================================================================
# Define 1 aplicação UDP rodando em cada Gateway
**.loRaGW[*].numUdpApps = 1

# Configuração do Packet Forwarder (comunicação GW <-> Server)
**.loRaGW[0].packetForwarder.localPort = 2000          # Porta onde o GW recebe respostas
**.loRaGW[0].packetForwarder.destPort = 1000           # Porta do Server para onde o GW envia
**.loRaGW[0].packetForwarder.destAddresses = "networkServer" # Endereço do destino

# Flag física: Habilita modo concentrador (escuta em múltiplos canais)
**.LoRaGWNic.radio.iAmGateway = true

# Impede inicialização via editor gráfico, força uso das coordenadas deste arquivo
**.loRaGW[*].**.initFromDisplayString = false


# ==============================================================================
# 3. Configurações do Servidor de Rede (Network Server)
# ==============================================================================
**.networkServer.numApps = 1

# Habilita o cálculo de ADR (Adaptive Data Rate) no servidor
**.networkServer.**.evaluateADRinServer = true

# Define a aplicação do servidor e portas de comunicação com o Gateway
**.networkServer.app[0].typename = "NetworkServerApp"
**.networkServer.app[0].destAddresses = "loRaGW[0]"
**.networkServer.app[0].destPort = 2000
**.networkServer.app[0].localPort = 1000

# Método usado para calcular o ADR (aqui definido como 'média')
**.networkServer.app[0].adrMethod = ${"avg"}


# ==============================================================================
# 4. Controle de Eventos e Tempo da Simulação
# ==============================================================================
# Quantidade de pacotes por nó (0 = infinito/até o fim do tempo)
**.numberOfPacketsToSend = 0 

# Distribuição exponencial para iniciar as transmissões (desincroniza nós)
**.timeToFirstPacket = exponential(1000s)

# Intervalo entre pacotes subsequentes (tráfego tipo Poisson)
**.timeToNextPacket = exponential(1000s)

# Desabilita modelo Aloha simples (usa modelo de colisão complexo do FLoRa)
**.alohaChannelModel = false

# Duração total da simulação (1 dia simulado)
sim-time-limit = 1d

# Resolução do relógio (10^-11 segundos) para precisão no rádio
simtime-resolution = -11

# Repete a simulação 5 vezes com seeds diferentes para média estatística
repeat = 5


# ==============================================================================
# 5. Configurações dos Nós (End Devices)
# ==============================================================================
# Parâmetros iniciais da camada física LoRa
**.loRaNodes[*].**initialLoRaSF = 12       # Spreading Factor (12 = maior alcance/menor taxa)
**.loRaNodes[*].**initialLoRaTP = 14dBm    # Potência de Transmissão
**.loRaNodes[*].**initialLoRaBW = 125 kHz  # Largura de Banda
**.loRaNodes[*].**initialLoRaCR = 4        # Coding Rate

# Permite que o nó entenda comandos de ADR vindos do servidor
**.loRaNodes[*].**.evaluateADRinNode = true

# Configuração da aplicação rodando no nó
**.loRaNodes[*].numApps = 1
**.loRaNodes[*].app[0].typename = "SimpleLoRaApp"

# Ignora posições do editor visual
**.loRaNodes[*].**.initFromDisplayString = false


# ==============================================================================
# 6. Consumo de Energia
# ==============================================================================
# Módulo que contabiliza o gasto energético do rádio
**.loRaNodes[*].LoRaNic.radio.energyConsumer.typename = "LoRaEnergyConsumer"

# Fonte de energia (Bateria ideal/infinita)
**.loRaNodes[*].**.energySourceModule = "^.IdealEpEnergyStorage"

# Arquivo XML contendo os valores de corrente (mA) para cada estado (RX, TX, Sleep)
**.loRaNodes[*].LoRaNic.radio.energyConsumer.configFile = xmldoc("../energyConsumptionParameters.xml")


# ==============================================================================
# 7. Camada Física e Modelo de Propagação (Path Loss)
# ==============================================================================
# Configurações internas do rádio (simplificação de log)
LoRaNetworkTest.**.radio.separateTransmissionParts = false
LoRaNetworkTest.**.radio.separateReceptionParts = false

# Atrasos simulados da nuvem/internet
**.ipv4Delayer.config = xmldoc("../cloudDelays.xml")

# Define o meio físico como LoRa
**.radio.radioMediumModule = "LoRaMedium"

# Modelo de Perda de Caminho: Log-Normal Shadowing / Empírico
**.LoRaMedium.pathLoss.typename = "LoRaEmpiricalPathLoss"
**.LoRaMedium.pathLoss.d0 = 1m              # Distância de referência
**.LoRaMedium.pathLoss.n = 4.23             # Expoente de perda (Ambiente denso/obstruído)
**.LoRaMedium.pathLoss.B = 72.86            # Perda fixa na distância de referência
**.LoRaMedium.pathLoss.sigma = 6.61         # Desvio padrão do sombreamento (dB)
**.LoRaMedium.pathLoss.txAntennaGain_dB = 2.0 # Ganho antena TX
**.LoRaMedium.pathLoss.rxAntennaGain_dB = 6.0 # Ganho antena RX

# Resolução de interferência e visualização de endereços
**.minInterferenceTime = 0s
**.displayAddresses = false


# ==============================================================================
# 8. Topologia e Mapa (Geometria)
# ==============================================================================
# Quantidade de dispositivos na rede
**.numberOfNodes = 1
**.numberOfGateways = 1

# Dimensões da área de simulação (em metros)
**.constraintAreaMinX = 0m
**.constraintAreaMinY = 0m
**.constraintAreaMinZ = 0m
**.constraintAreaMaxZ = 0m
**.constraintAreaMaxX = 2376.0m
**.constraintAreaMaxY = 1090.0m

# Posição inicial fixa do Gateway
**.loRaGW[0].**.initialX = 544.00m
**.loRaGW[0].**.initialY = 544.00m

# Posição inicial fixa do Nó (Node)
**.loRaNodes[0].**.initialX = 590.63m
**.loRaNodes[0].**.initialY = 529.08m
**.loRaNodes[1].**.initialX = 488.29m
**.loRaNodes[1].**.initialY = 504.24m
**.loRaNodes[2].**.initialX = 561.60m
**.loRaNodes[2].**.initialY = 570.25m
**.loRaNodes[3].**.initialX = 556.86m
**.loRaNodes[3].**.initialY = 529.63m
**.loRaNodes[4].**.initialX = 527.85m
**.loRaNodes[4].**.initialY = 484.11m
**.loRaNodes[5].**.initialX = 555.27m
**.loRaNodes[5].**.initialY = 541.84m
**.loRaNodes[6].**.initialX = 561.11m
**.loRaNodes[6].**.initialY = 614.96m
**.loRaNodes[7].**.initialX = 557.86m
**.loRaNodes[7].**.initialY = 575.17m
**.loRaNodes[8].**.initialX = 500.41m
**.loRaNodes[8].**.initialY = 537.16m
**.loRaNodes[9].**.initialX = 530.53m
**.loRaNodes[9].**.initialY = 594.82m
**.loRaNodes[10].**.initialX = 584.04m
**.loRaNodes[10].**.initialY = 592.09m
**.loRaNodes[11].**.initialX = 515.13m
**.loRaNodes[11].**.initialY = 576.19m
**.loRaNodes[12].**.initialX = 555.84m
**.loRaNodes[12].**.initialY = 491.29m
**.loRaNodes[13].**.initialX = 508.39m
**.loRaNodes[13].**.initialY = 540.81m
**.loRaNodes[14].**.initialX = 602.97m
**.loRaNodes[14].**.initialY = 561.72m
**.loRaNodes[15].**.initialX = 573.86m
**.loRaNodes[15].**.initialY = 598.74m
**.loRaNodes[16].**.initialX = 563.36m
**.loRaNodes[16].**.initialY = 537.56m
**.loRaNodes[17].**.initialX = 572.20m
**.loRaNodes[17].**.initialY = 470.62m
**.loRaNodes[18].**.initialX = 580.10m
**.loRaNodes[18].**.initialY = 569.43m
**.loRaNodes[19].**.initialX = 482.45m
**.loRaNodes[19].**.initialY = 568.30m
**.loRaNodes[20].**.initialX = 516.07m
**.loRaNodes[20].**.initialY = 544.85m
**.loRaNodes[21].**.initialX = 556.49m
**.loRaNodes[21].**.initialY = 536.00m
**.loRaNodes[22].**.initialX = 522.74m
**.loRaNodes[22].**.initialY = 509.30m
**.loRaNodes[23].**.initialX = 499.69m
**.loRaNodes[23].**.initialY = 538.38m
**.loRaNodes[24].**.initialX = 567.54m
**.loRaNodes[24].**.initialY = 598.27m
**.loRaNodes[25].**.initialX = 556.39m
**.loRaNodes[25].**.initialY = 466.21m
**.loRaNodes[26].**.initialX = 605.22m
**.loRaNodes[26].**.initialY = 496.41m
**.loRaNodes[27].**.initialX = 598.55m
**.loRaNodes[27].**.initialY = 514.84m
**.loRaNodes[28].**.initialX = 551.92m
**.loRaNodes[28].**.initialY = 566.44m
**.loRaNodes[29].**.initialX = 536.24m
**.loRaNodes[29].**.initialY = 559.14m
**.loRaNodes[30].**.initialX = 537.33m
**.loRaNodes[30].**.initialY = 593.43m
**.loRaNodes[31].**.initialX = 498.73m
**.loRaNodes[31].**.initialY = 601.05m
**.loRaNodes[32].**.initialX = 503.11m
**.loRaNodes[32].**.initialY = 532.76m
**.loRaNodes[33].**.initialX = 553.67m
**.loRaNodes[33].**.initialY = 515.57m
**.loRaNodes[34].**.initialX = 565.77m
**.loRaNodes[34].**.initialY = 542.20m
**.loRaNodes[35].**.initialX = 566.26m
**.loRaNodes[35].**.initialY = 610.68m
**.loRaNodes[36].**.initialX = 546.38m
**.loRaNodes[36].**.initialY = 538.55m
**.loRaNodes[37].**.initialX = 535.15m
**.loRaNodes[37].**.initialY = 477.32m
**.loRaNodes[38].**.initialX = 606.79m
**.loRaNodes[38].**.initialY = 575.52m
**.loRaNodes[39].**.initialX = 579.76m
**.loRaNodes[39].**.initialY = 575.87m
**.loRaNodes[40].**.initialX = 490.89m
**.loRaNodes[40].**.initialY = 492.01m
**.loRaNodes[41].**.initialX = 586.40m
**.loRaNodes[41].**.initialY = 561.89m
**.loRaNodes[42].**.initialX = 523.70m
**.loRaNodes[42].**.initialY = 583.73m
**.loRaNodes[43].**.initialX = 499.64m
**.loRaNodes[43].**.initialY = 492.02m
**.loRaNodes[44].**.initialX = 469.79m
**.loRaNodes[44].**.initialY = 557.09m
**.loRaNodes[45].**.initialX = 537.67m
**.loRaNodes[45].**.initialY = 517.07m
**.loRaNodes[46].**.initialX = 479.33m
**.loRaNodes[46].**.initialY = 517.79m
**.loRaNodes[47].**.initialX = 473.81m
**.loRaNodes[47].**.initialY = 546.74m
**.loRaNodes[48].**.initialX = 492.05m
**.loRaNodes[48].**.initialY = 569.43m
**.loRaNodes[49].**.initialX = 553.93m
**.loRaNodes[49].**.initialY = 552.00m
**.loRaNodes[50].**.initialX = 534.72m
**.loRaNodes[50].**.initialY = 533.28m
**.loRaNodes[51].**.initialX = 499.21m
**.loRaNodes[51].**.initialY = 541.59m
**.loRaNodes[52].**.initialX = 544.34m
**.loRaNodes[52].**.initialY = 620.21m
**.loRaNodes[53].**.initialX = 545.79m
**.loRaNodes[53].**.initialY = 492.78m
**.loRaNodes[54].**.initialX = 577.88m
**.loRaNodes[54].**.initialY = 561.80m
**.loRaNodes[55].**.initialX = 566.79m
**.loRaNodes[55].**.initialY = 580.54m
**.loRaNodes[56].**.initialX = 571.55m
**.loRaNodes[56].**.initialY = 471.95m
**.loRaNodes[57].**.initialX = 588.01m
**.loRaNodes[57].**.initialY = 497.99m
**.loRaNodes[58].**.initialX = 571.83m
**.loRaNodes[58].**.initialY = 610.10m
**.loRaNodes[59].**.initialX = 470.72m
**.loRaNodes[59].**.initialY = 525.51m
**.loRaNodes[60].**.initialX = 601.10m
**.loRaNodes[60].**.initialY = 500.33m
**.loRaNodes[61].**.initialX = 578.75m
**.loRaNodes[61].**.initialY = 572.77m
**.loRaNodes[62].**.initialX = 509.74m
**.loRaNodes[62].**.initialY = 560.89m
**.loRaNodes[63].**.initialX = 590.38m
**.loRaNodes[63].**.initialY = 488.46m
**.loRaNodes[64].**.initialX = 537.34m
**.loRaNodes[64].**.initialY = 543.55m
**.loRaNodes[65].**.initialX = 553.01m
**.loRaNodes[65].**.initialY = 594.89m
**.loRaNodes[66].**.initialX = 529.51m
**.loRaNodes[66].**.initialY = 567.61m
**.loRaNodes[67].**.initialX = 509.52m
**.loRaNodes[67].**.initialY = 613.61m
**.loRaNodes[68].**.initialX = 527.24m
**.loRaNodes[68].**.initialY = 488.87m
**.loRaNodes[69].**.initialX = 591.49m
**.loRaNodes[69].**.initialY = 535.49m
**.loRaNodes[70].**.initialX = 543.12m
**.loRaNodes[70].**.initialY = 622.48m
**.loRaNodes[71].**.initialX = 526.27m
**.loRaNodes[71].**.initialY = 597.55m
**.loRaNodes[72].**.initialX = 585.55m
**.loRaNodes[72].**.initialY = 553.81m
**.loRaNodes[73].**.initialX = 481.55m
**.loRaNodes[73].**.initialY = 542.95m
**.loRaNodes[74].**.initialX = 540.75m
**.loRaNodes[74].**.initialY = 561.86m
**.loRaNodes[75].**.initialX = 549.00m
**.loRaNodes[75].**.initialY = 620.08m
**.loRaNodes[76].**.initialX = 513.61m
**.loRaNodes[76].**.initialY = 546.02m
**.loRaNodes[77].**.initialX = 547.96m
**.loRaNodes[77].**.initialY = 623.33m
**.loRaNodes[78].**.initialX = 548.78m
**.loRaNodes[78].**.initialY = 478.59m
**.loRaNodes[79].**.initialX = 538.68m
**.loRaNodes[79].**.initialY = 505.37m
**.loRaNodes[80].**.initialX = 511.30m
**.loRaNodes[80].**.initialY = 508.16m
**.loRaNodes[81].**.initialX = 481.93m
**.loRaNodes[81].**.initialY = 529.81m
**.loRaNodes[82].**.initialX = 556.28m
**.loRaNodes[82].**.initialY = 523.33m
**.loRaNodes[83].**.initialX = 561.60m
**.loRaNodes[83].**.initialY = 585.75m
**.loRaNodes[84].**.initialX = 530.41m
**.loRaNodes[84].**.initialY = 535.27m
**.loRaNodes[85].**.initialX = 609.49m
**.loRaNodes[85].**.initialY = 550.85m
**.loRaNodes[86].**.initialX = 552.42m
**.loRaNodes[86].**.initialY = 600.63m
**.loRaNodes[87].**.initialX = 573.40m
**.loRaNodes[87].**.initialY = 601.14m
**.loRaNodes[88].**.initialX = 493.64m
**.loRaNodes[88].**.initialY = 587.43m
**.loRaNodes[89].**.initialX = 594.28m
**.loRaNodes[89].**.initialY = 602.88m
**.loRaNodes[90].**.initialX = 579.34m
**.loRaNodes[90].**.initialY = 574.56m
**.loRaNodes[91].**.initialX = 599.19m
**.loRaNodes[91].**.initialY = 490.41m
**.loRaNodes[92].**.initialX = 522.23m
**.loRaNodes[92].**.initialY = 509.70m
**.loRaNodes[93].**.initialX = 475.99m
**.loRaNodes[93].**.initialY = 519.42m
**.loRaNodes[94].**.initialX = 546.98m
**.loRaNodes[94].**.initialY = 602.15m
**.loRaNodes[95].**.initialX = 563.49m
**.loRaNodes[95].**.initialY = 529.31m
**.loRaNodes[96].**.initialX = 493.12m
**.loRaNodes[96].**.initialY = 487.66m
**.loRaNodes[97].**.initialX = 516.81m
**.loRaNodes[97].**.initialY = 581.82m
**.loRaNodes[98].**.initialX = 598.41m
**.loRaNodes[98].**.initialY = 502.94m
**.loRaNodes[99].**.initialX = 558.06m
**.loRaNodes[99].**.initialY = 469.98m
